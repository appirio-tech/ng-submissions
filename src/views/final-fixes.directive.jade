loader(ng-show="!vm.loaded")

include parts/header

include parts/timeline

section(ng-if="vm.status == 'scheduled'")
  h4 Final Fixes Phase starts in &hellip;

  countdown(end="{{ vm.work.phase.startDate }}")

section(ng-if="vm.status == 'closed'")
  h4 Project Complete! Review final submission

section(ng-if="vm.status == 'open'")
  h4(ng-if="!vm.approvalConfirmed") Give final feedback and accept the submission to complete the project.

  countdown(end="{{ vm.work.phase.endDate }}")

  p.duration remaining to give feedback

section(ng-if="vm.status == 'open' || vm.status == 'closed'")

  ul.winner
    li.download
      button.clean
        a(href="{{ vm.submission.downloadUrl }}")
          .icon.download

    li
      a(href="{{ vm.submission.downloadUrl }}") Download final submission

    li
      a(ui-sref="submission-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: 'winner' })") View previous submission comments

  ul.approval(ng-if="vm.status == 'open'")
    li.confirm
      button.info(ng-click="vm.confirmApproval()") Confirm final approval

  hr

  ul.previews
    li.preview(ng-repeat="file in vm.submission.files track by $index")
      ul.icons
        li.notification
          button.clean
            a(ui-sref="file-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: vm.submission.id, fileId: file.id})") {{ file.unreadMessages }}

        li
          button.clean
            a(href="{{ file.images.full }}", target="_blank")
              .icon.download.smallest

      img.img(ng-src="{{ file.images.small }}" ui-sref="file-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: vm.submission.id, fileId: file.id})")

      a(ui-sref="file-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: vm.submission.id, fileId: file.id})") {{ file.name }}

