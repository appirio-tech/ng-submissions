loader(ng-hide="vm.loaded")

include parts/header

include parts/subheader-member

include parts/subheader-customer

include parts/subheader-shared

ul.submissions(ng-if="vm.statusValue > 3")
  li.submission.flex.elevated-bottom(ng-repeat="submission in vm.submissions track by $index" data-id="{{ submission.id }}" ng-class="{ 'belongs-to-user': submission.belongsToUser }" draggable)
    ul.user-details.flex.middle
      li
        avatar(avatar-url="{{ submission.submitter.avatar }}")

      li
        .name-time
          .name {{ submission.submitter.handle }}
            span(ng-if="submission.belongsToUser") &nbsp;(Me)

          p {{ submission.files.length }} Images

    ul.thumbnails.flex-grow
      li.thumbnail(ng-repeat="file in submission.files track by $index")
        a(ui-sref="file-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: submission.id, fileId: file.id})")
          img.img(ng-src="{{ file.url }}")

        .pop-over.elevated
          a.preview(ui-sref="file-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: submission.id, fileId: file.id})")
            img.previewImage(ng-src="{{ file.url }}")

          a(ui-sref="file-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: submission.id, fileId: file.id})")
            .icon.envelope

          a(href="{{ file.url }}", target="_blank")
            .clean.icon.download

    ul.actions.flex.middle.wrap
      li
        a(ui-sref="submission-detail({projectId: vm.projectId, stepId: vm.stepId, submissionId: submission.id})") view all

      li.comments(ng-if="vm.status != 'CLOSED'")
        a(href="{{ submission.downloadUrl }}", target="_blank")
          .icon.download.small

      li.comments(ng-if="vm.status == 'CLOSED' && submission.rank")
        a(href="{{ submission.downloadUrl }}", target="_blank")
          .icon.download.small

      li(ng-if="vm.userType != 'member' && vm.status != 'CLOSED'")
        select(ng-model="submission.rank", ng-change="vm.handleRankSelect(submission)", ng-options="rank.value as rank.label for rank in vm.ranks")

      li(ng-if="vm.status == 'CLOSED'") {{ vm.rankNames[$index] }}
